<div th:fragment="content">
    <h2>Quản lý Rạp</h2>
        <div class="row mb-4">
            <div>
                <label for="cinemaSelect" class="form-label fw-bold">Chọn rạp bạn quản lý:</label>
                <select id="cinemaSelect" class="form-select">
                    <option value="" selected disabled>-- Chọn rạp --</option>
                    <option th:each="cinema : ${cinemas}"
                            th:value="${cinema.id}"
                            th:text="${cinema.name}">
                    </option>
                </select>
            </div>
        </div>

        <div class="row" id="roomsContainer"></div>

<script src="/bootstrap/js/bootstrap.bundle.min.js"></script>
<script th:inline="javascript">
        const cinemaSelect = document.getElementById("cinemaSelect");
        const roomsContainer = document.getElementById("roomsContainer");

        // Khi chọn rạp, fetch danh sách phòng chiếu
        cinemaSelect.addEventListener("change", function () {
            const cinemaId = this.value;
            if (!cinemaId) return;

            roomsContainer.innerHTML = '';

            fetch(`/cinema/${cinemaId}/rooms`)
                .then(res => res.json())
                .then(rooms => {
                    if (!rooms || rooms.length === 0) {
                        roomsContainer.innerHTML = '<p class="text-muted">Chưa có phòng chiếu cho rạp này.</p>';
                        return;
                    }
                    rooms.forEach(room => {
                        const cardCol = document.createElement("div");
                        cardCol.className = "col-md-4 mb-4";
                        cardCol.innerHTML = `
                            <div class="card h-100" style="cursor:pointer;" onclick="window.location.href='/room/${room.id}/seats'">
                                <div class="card-body">
                                    <h5 class="card-title">${room.name}</h5>
                                    <p class="card-text">Số ghế: ${room.quantitySeats}</p>
                                </div>
                            </div>`;
                        roomsContainer.appendChild(cardCol);
                    });
                })
                .catch(err => console.error("Lỗi fetch phòng chiếu:", err));
        });
    /*]]>*/
</script>
</div>
