<div th:fragment="content">
    <div class="card shadow-lg">
        <div class="row g-0">
            <!-- Poster -->
            <div class="col-md-4">
                <img th:src="${movie.posterUrl}" class="img-fluid rounded-start" alt="Poster">
            </div>

            <!-- Movie details -->
            <div class="col-md-8">
                <div class="card-body">
                    <h2 class="card-title" th:text="${movie.title}">Movie Title</h2>
                    <p class="card-text">
                        <strong th:text="#{movie.description}">Description:</strong>
                        <span th:text="${movie.description}">Movie description...</span>
                    </p>

                    <p class="card-text">
                        <strong th:text="#{movie.duration}">Duration:</strong>
                        <span th:text="${movie.duration}">120</span>
                        <span th:text="#{movie.minutes}">minutes</span>
                    </p>

                    <p class="card-text">
                        <strong th:text="#{movie.language}">Language:</strong>
                        <span th:text="${movie.language}">English</span>
                    </p>

                    <p class="card-text">
                        <strong th:text="#{movie.releaseDate}">Release Date:</strong>
                        <span th:text="${movie.releaseDate}">2023-01-01</span>
                    </p>

                    <p class="card-text">
                        <strong th:text="#{movie.genres}">Genres:</strong>
                        <span th:each="genre : ${movie.genres}"
                              class="badge bg-primary me-1"
                              th:text="${genre}">Action</span>
                    </p>

                    <a th:if="${!showReviews}"
                       th:href="@{/admin/movies/{id}(id=${movie.id}, page=${reviews.number}, size=${reviews.size}, showReviews=true)}"
                       class="btn btn-info mt-3">
                        <i class="bi bi-star-fill me-1"></i> <span th:text="#{movie.reviews.show}">Xem đánh giá</span>
                    </a>

                    <button th:if="${showReviews}"
                            type="button"
                            class="btn btn-info mt-3"
                            onclick="document.getElementById('reviewDiv').classList.toggle('d-none');">
                        <i class="bi bi-star-fill me-1"></i> <span th:text="#{movie.reviews.show}">Xem đánh giá</span>
                    </button>

                </div>
            </div>
        </div>
    </div>


    <!-- Div chứa đánh giá, ẩn-->
    <div id="reviewDiv" class="mt-3" th:classappend="${showReviews} ? '' : 'd-none'">
        <div  class="text-muted" th:if="${#lists.isEmpty(reviews.content)}" th:text="#{movie.reviews.empty}">
            Chưa có đánh giá nào.
        </div>
        <ul class="list-group" id="review-item" th:each="review : ${reviews.content}">
            <li class="list-group-item">
                <div class="d-flex">
                    <!-- Cột 1: 3/4 -->
                    <div class="flex-grow-1 pe-3">
                        <strong th:text="${review.userName}">Người dùng</strong>
                        <p class="mb-1 text-muted fs-7" th:text="${review.email}">email</p>
                        <p id="review-comment" th:text="${review.comment}">Nội dung đánh giá...</p>
                        <span class="text-muted" th:text="${#temporals.format(review.reviewDate, 'dd/MM/yyyy HH:mm')}">
                            2025-08-27 21:00
                        </span>
                    </div>

                    <!-- Cột 2: 1/4 -->
                    <div class="d-flex flex-column align-items-start align-items-md-end" style="min-width: 120px;">
                        <span class="mb-2">
                            <strong th:text="${review.rating}"></strong>
                            <i class="bi bi-star-fill me-1 text-warning"></i>
                        </span>
                        <p class="mb-2">
                            <strong th:text="#{review.status}">Trạng thái: </strong>
                            <span class="review-status text-success" th:if="${review.isDisplay == 1}" th:text="#{review.status.visible}"></span>
                            <span class="review-status text-danger" th:if="${review.isDisplay != 1}" th:text="#{review.status.hidden}"></span>
                        </p>

                        <button class="btn btn-sm btn-outline-primary"
                                th:attr="data-id=${review.id}"
                                th:text="${review.isDisplay == 1} ? #{review.action.hide} : #{review.action.show}"
                                onclick="toggleDisplay(this)">
                        </button>

                    </div>
                </div>
            </li>

        </ul>

        <!-- Pagination simple -->
        <nav th:if="${reviews.totalPages > 1}" aria-label="Page navigation">
            <ul class="pagination justify-content-center mt-3">

                <!-- Previous -->
                <li class="page-item" th:classappend="${reviews.first} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/admin/movies/{id}(id=${movie.id}, page=${reviews.number - 1}, size=${reviews.size}, showReviews=${showReviews})}">
                        «
                    </a>
                </li>

                <!-- Page numbers -->
                <li th:each="i : ${#numbers.sequence(0, reviews.totalPages - 1)}"
                    th:classappend="${i == reviews.number} ? 'active'"
                    class="page-item">
                    <a class="page-link"
                       th:text="${i + 1}"
                       th:href="@{/admin/movies/{id}(id=${movie.id}, page=${i}, size=${reviews.size}, showReviews=${showReviews})}">
                    </a>
                </li>

                <!-- Next -->
                <li class="page-item" th:classappend="${reviews.last} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/admin/movies/{id}(id=${movie.id}, page=${reviews.number + 1}, size=${reviews.size}, showReviews=${showReviews})}">
                        »
                    </a>
                </li>


            </ul>
        </nav>


    </div>

</div>
